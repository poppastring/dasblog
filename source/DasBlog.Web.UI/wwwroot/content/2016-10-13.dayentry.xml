<?xml version="1.0" encoding="utf-8"?>
<DayEntry xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="urn:newtelligence-com:dasblog:runtime:data">
  <Date>2016-10-12T17:00:00-07:00</Date>
  <Entries>
    <Entry>
      <Content>&lt;a href="http://www.poppastring.com/blog/content/binary/Windows-Live-Writer/Designing-to-Detect-a-Leak_CE20/OhioCaverns_2.jpg"&gt;&lt;figure&gt;&lt;img title="Ohio Caverns, West Liberty" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="Ohio Caverns, West Liberty" src="http://www.poppastring.com/blog/content/binary/Windows-Live-Writer/Designing-to-Detect-a-Leak_CE20/OhioCaverns_thumb.jpg" width="1024" height="416"&gt;&lt;/figure&gt;&lt;/a&gt;  &lt;p&gt;One of the problems I have in my field is that it is sometimes difficult to produce clear unassailable facts, for example a problem can occur once a year in a production environment that is difficult to replicate or account for in a development setting. We are generally expressing a set of truths that exist in a particular space and time (aka OS, memory constraint, CPU load, network load etc.). Let me quote from &lt;a href="https://en.wikipedia.org/wiki/Indiana_Jones_and_the_Last_Crusade"&gt;The Last Crusade&lt;/a&gt; just to help my point:&lt;/p&gt; &lt;blockquote&gt; &lt;p&gt;&lt;strong&gt;Indiana Jones:&lt;/strong&gt; Archaeology is the search for fact, not truth. If it's truth you're interested in, Dr. Tyree's Philosophy class is right down the hall. So forget any ideas you've got about lost cities, exotic travel, and digging up the world. We do not follow maps to buried treasure, and "X" never, ever marks the spot.&lt;/p&gt;&lt;/blockquote&gt; &lt;p&gt;Just a few minutes after this memorable statement Indy is doing what action heroes do finding buried and unrecoverable information. For a moment our protagonist is standing directly on the spot he needs but does not actually realize it, not that he is missing the information or that or is looking in the wrong place, it is his perspective that keeps him in the dark. Everyone had missed that “X” had indeed marked the spot. One of the things lost on me when I first watched Indiana Jones, as noted in his quotes, was that this particular action hero was really a scholar. Throughout the movies these two distinct parts of Jones' character were both complimentary and in conflict.&lt;/p&gt; &lt;p&gt;There is on occasion a precarious relationship between theory and practice and this makes space for what looks like &lt;a href="http://www.poppastring.com/blog/AnySufficientlyAdvancedEngineer.aspx"&gt;magical intuition&lt;/a&gt; but our engineering discipline is honed by experience and perspective.&lt;/p&gt; &lt;h3&gt;Detecting a Leak&lt;/h3&gt; &lt;p&gt;One of the first tasks when designing large platform or service is to ensure that you can measure load, for the type of systems I design this usually takes the form of an authenticated session. Once you understand what an Authenticated session is for you having the ability to monitor the session count is quintessential for monitoring, there are many ways to do this but the most intuitive to read is share data via &lt;a href="https://msdn.microsoft.com/en-us/library/ff650681.aspx"&gt;Performance Counters&lt;/a&gt;.&lt;/p&gt; &lt;p&gt;If we setup performance monitoring for the following: &lt;/p&gt; &lt;ul&gt; &lt;li&gt;Authenticated sessions: A custom performance counter that in this case measures active sessions  &lt;li&gt;Private bytes: Total bytes =&amp;gt; Managed + unmanaged  &lt;li&gt;GC Heap: Managed &lt;/li&gt;&lt;/ul&gt; &lt;p&gt;Depending on what we see, we can come to one or more of the following conclusions. &lt;/p&gt; &lt;ol&gt; &lt;li&gt;In a healthy environment we expect that number of Authenticated sessions to be directly proportional to Private bytes and GC Heap, that is, as the Authenticated session count goes up so will the memory allocations necessary to deal with the increase. Conversely when the Authenticated sessions go down, we expect some recovery from Private bytes and GC Heap (based on GC execution).  &lt;li&gt;If over the course of time Authenticated sessions increase and decrease, but Private bytes trend continue to increase (but not GC Heap) we can say, in a very general sense, that we have a leak in managed or unmanaged memory (or both).  &lt;li&gt;If over the course of time Authenticated sessions increase and decrease, but the GC Heap trend continue to increase but not Private bytes does indeed recover we can say, in a very general sense, that we have a leak in managed memory.  &lt;li&gt;If over the course of time Authenticated sessions increase and decrease, but Private bytes trend continue to increase but the GC Heap does indeed recover we can say, in a very general sense, that we have a leak in unmanaged memory.&lt;/li&gt;&lt;/ol&gt; &lt;p&gt;Get to know performance counters they add almost imperceptible overhead but offer clues that you would otherwise miss. You see enough of these performance graphs and it eventually becomes easier to detect the facts buried in the truth, in this way X (and Y) always mark the spot.&lt;/p&gt;</Content>
      <Created>2016-10-12T19:36:57.263-07:00</Created>
      <Modified>2016-10-27T17:07:28.388428-07:00</Modified>
      <EntryId>bbecae4b-e3a3-47a2-b6a6-b4cc405f8663</EntryId>
      <Description>One of the problems I have in my field is that it is sometimes difficult to produce clear unassailable facts, for example, a problem can occur once a year in a production environment that is difficult to replicate or account for in a development setting. We are generally expressing a set of truths that exist in a particular space and time (aka OS, memory constraint, CPU load, network load etc.). Let me quote from The Last Crusade just to help my point...&lt;br&gt;</Description>
      <Title>General Patterns used to Detect a Leak</Title>
      <Categories>Design Pattern;Web</Categories>
      <Author>admin</Author>
      <IsPublic>true</IsPublic>
      <Syndicated>true</Syndicated>
      <ShowOnFrontPage>true</ShowOnFrontPage>
      <AllowComments>true</AllowComments>
      <Attachments />
      <Crossposts />
      <Latitude xsi:nil="true" />
      <Longitude xsi:nil="true" />
    </Entry>
  </Entries>
</DayEntry>